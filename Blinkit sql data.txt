SELECT * FROM Blinkit_data

SELECT COUNT(*) FROM Blinkit_data

UPDATE Blinkit_data
SET Item_Fat_Content =
CASE
WHEN Item_Fat_Content IN ('LF', 'low fat') THEN 'LOW FAT'
WHEN Item_Fat_Content = 'reg' THEN 'Regular'
ELSE Item_Fat_Content
END

SELECT DISTINCT (Item_Fat_Content) FROM Blinkit_data

SELECT SUM(Sales) FROM Blinkit_data

SELECT SUM(Sales) AS Total_Sales FROM Blinkit_data

SELECT CAST(SUM(Sales) / 1000000 AS DECIMAL(10,2)) AS Total_sales_Millions
FROM Blinkit_data
WHERE Outlet_Establishment_Year = 2022;

SELECT AVG(Sales) FROM Blinkit_data

SELECT AVG(Sales) AS Avg_Sales FROM Blinkit_data

SELECT CAST(AVG(Sales) AS decimal (10,1)) AS Avg_Sales 
FROM Blinkit_data

SELECT COUNT(*) FROM Blinkit_data

SELECT COUNT(*) AS No_Of_Items FROM Blinkit_data

SELECT AVG(Rating) FROM Blinkit_data

SELECT AVG(Rating) AS Avg_Rating FROM Blinkit_data

SELECT CAST(AVG(Rating) AS decimal(10,2)) AS Avg_Rating FROM Blinkit_data

SELECT Item_Fat_Content,
       CAST(SUM (Sales) AS decimal(10,2)) AS Total_Sales,
	   CAST(AVG(Sales) AS decimal (10,1)) AS Avg_Sales,
	   COUNT(*) AS No_Of_Items,
	   CAST(AVG(Rating) AS decimal(10,2)) AS Avg_Rating
FROM Blinkit_data
GROUP BY Item_Fat_Content
ORDER BY Total_Sales DESC

SELECT Item_Type,
       CAST(SUM (Sales) AS decimal(10,2)) AS Total_Sales,
	   CAST(AVG(Sales) AS decimal (10,1)) AS Avg_Sales,
	   COUNT(*) AS No_Of_Items,
	   CAST(AVG(Rating) AS decimal(10,2)) AS Avg_Rating
FROM Blinkit_data
GROUP BY Item_Type
ORDER BY Total_Sales DESC

SELECT Outlet_Location_Type,Item_Fat_Content,
       CAST(SUM (Sales) AS decimal(10,2)) AS Total_Sales,
	   CAST(AVG(Sales) AS decimal (10,1)) AS Avg_Sales,
	   COUNT(*) AS No_Of_Items,
	   CAST(AVG(Rating) AS decimal(10,2)) AS Avg_Rating
FROM Blinkit_data
GROUP BY Outlet_Location_Type,Item_Fat_Content
ORDER BY Total_Sales DESC

SELECT Outlet_Establishment_Year,
       CAST(SUM (Sales) AS decimal(10,2)) AS Total_Sales,
	   CAST(AVG(Sales) AS decimal (10,1)) AS Avg_Sales,
	   COUNT(*) AS No_Of_Items,
	   CAST(AVG(Rating) AS decimal(10,2)) AS Avg_Rating
FROM Blinkit_data
GROUP BY Outlet_Establishment_Year
ORDER BY Outlet_Establishment_Year ASC

SELECT 
    Outlet_Location_Type,
    ISNULL([Low Fat], 0) AS [Low Fat],
    ISNULL([Regular], 0) AS [Regular]
FROM
(
    SELECT 
        Outlet_Location_Type,
        Item_Fat_Content,
        CAST(SUM(Sales) AS DECIMAL(10,2)) AS Total_Sales
    FROM Blinkit_data
    GROUP BY Outlet_Location_Type, Item_Fat_Content
) AS SourceTable
PIVOT
(
    SUM(Total_Sales)
    FOR Item_Fat_Content IN ([Low Fat], [Regular])
) AS PivotTable
ORDER BY Outlet_Location_Type;    --FIXED ORDER BY CLAUSE

SELECT
    Outlet_Size,
    Total_Sales,
    CAST(Total_Sales * 100.0 / Total_Overall_Sales AS DECIMAL(10,2)) AS Sales_Percentage
FROM (
    SELECT
        Outlet_Size,
        CAST(SUM(Sales) AS DECIMAL(10,2)) AS Total_Sales,
        SUM(SUM(Sales)) OVER () AS Total_Overall_Sales
    FROM Blinkit_data
    GROUP BY Outlet_Size
) AS Subquery
ORDER BY Total_Sales DESC;

SELECT
    Outlet_Location_Type,
    Total_Sales,
    CAST(Total_Sales * 100.0 / Total_Overall_Sales AS DECIMAL(10,2)) AS Sales_Percentage,
    Avg_Sales,
    No_Of_Items,
    Avg_Rating
FROM (
    SELECT
        Outlet_Location_Type,
        CAST(SUM(Sales) AS DECIMAL(10,2)) AS Total_Sales,
        SUM(SUM(Sales)) OVER () AS Total_Overall_Sales,
        CAST(AVG(Sales) AS DECIMAL(10,1)) AS Avg_Sales,
        COUNT(*) AS No_Of_Items,
        CAST(AVG(Rating) AS DECIMAL(10,2)) AS Avg_Rating
    FROM Blinkit_data
    GROUP BY Outlet_Location_Type
) AS Subquery
ORDER BY Outlet_Location_Type DESC;

SELECT
    Outlet_Type,
    Total_Sales,
    CAST(Total_Sales * 100.0 / Total_Overall_Sales AS DECIMAL(10,2)) AS Sales_Percentage,
    Avg_Sales,
    No_Of_Items,
    Avg_Rating
FROM (
    SELECT
        Outlet_Type,
        CAST(SUM(Sales) AS DECIMAL(10,2)) AS Total_Sales,
        SUM(SUM(Sales)) OVER () AS Total_Overall_Sales,
        CAST(AVG(Sales) AS DECIMAL(10,1)) AS Avg_Sales,
        COUNT(*) AS No_Of_Items,
        CAST(AVG(Rating) AS DECIMAL(10,2)) AS Avg_Rating
    FROM Blinkit_data
    GROUP BY Outlet_Type
) AS Subquery
ORDER BY Total_Sales DESC;